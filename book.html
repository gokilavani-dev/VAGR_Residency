<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Vagr Residency</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- AOS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

<!-- CSS -->
<link rel="stylesheet" href="css/style.css"/>
<link rel="stylesheet" href="css/book.css"/>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center" href="#">
      <img src="images/vagr_logo.png" class="logo me-2" alt="Logo">
      <h1 class="mb-0">Vagr Residency</h1>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="index.html#aboutus">About us</a></li>
        <li class="nav-item"><a class="nav-link" href="index.html#services">Services</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item"><a class="nav-link book" href="book.html">Booking</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="booking-container">
  <div class="booking-card" data-aos="fade-right">
    <h2>Book Your Stay</h2>
    <form id="bookingForm">
      <div class="form-group">
        <label>Full Name</label>
        <input id="name" type="text" placeholder="Your full name">
      </div>
      <div class="form-group">
        <label>Phone</label>
        <input id="phone" type="tel" placeholder="Enter phone">
      </div>
      <div class="form-group">
        <label>Rooms</label>
        <select id="rooms">
          <option value="1">1 Room</option>
          <option value="2">2 Rooms</option>
          <option value="3">3 Rooms</option>
          <option value="4">4 Rooms</option>
          <option value="5">5 Rooms</option>
        </select>
      </div>
      <div class="row">
        <div class="col"><label>Adults</label><input id="adults" type="number" min="1" value="1"></div>
        <div class="col"><label>Children</label><input id="children" type="number" min="0" value="0"></div>
      </div>
      <div class="row mt-2">
        <div class="col"><label>Check-in</label><input id="checkin" type="date"></div>
        <div class="col"><label>Check-out</label><input id="checkout" type="date"></div>
      </div>
      <button type="button" id="checkBtn" class="btn-main">Check Availability</button>
      <button type="button" id="bookBtn" class="btn-main mt-2">Book Now</button>
      <div id="bookingResult" style="margin-top:10px;color:green;"></div>

      <div class="cancel-box mt-3">
        <button type="button" id="toggleCancel" class="cancel-toggle">Cancel a Booking</button>
        <div id="cancelArea" class="cancel-area" style="display:none;margin-top:10px;">
          <input id="cancelPhone" type="text" placeholder="Phone used for booking" />
          <input id="cancelCheckin" type="date" />
          <button id="cancelBtn" type="button" class="btn-cancel">Submit Cancel</button>
          <div id="cancelMessage" style="margin-top:5px;color:red;"></div>
        </div>
      </div>
    </form>
  </div>

  <div class="booking-image" data-aos="fade-left">
    <img src="images/booking.jpg" alt="Room Image">
  </div>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwKVMAXg5H8cy7y3sQ4TPli84EM-CxPaaeX8UkwGyG9Ox-dXYpA9KUlNl4rDcblzteCtQ/exec";

document.getElementById("toggleCancel").addEventListener("click", () => {
  const c = document.getElementById("cancelArea");
  c.style.display = c.style.display === "block" ? "none" : "block";
});

// CHECK AVAILABILITY
document.getElementById("checkBtn").addEventListener("click", async () => {
  const payload = { formType:"check", checkin: document.getElementById("checkin").value, checkout: document.getElementById("checkout").value };
  try { const res = await fetch(WEB_APP_URL, { method:"POST", body:JSON.stringify(payload) }); const data = await res.json();
    document.getElementById("bookingResult").innerText = data.available > 0 ? `${data.available} rooms available` : "No rooms available"; 
  } catch(e){ document.getElementById("bookingResult").innerText = "Network error"; }
});

// BOOK NOW
document.getElementById("bookBtn").addEventListener("click", async () => {
  const payload = {
    formType:"book",
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    rooms: document.getElementById("rooms").value,
    adults: document.getElementById("adults").value,
    children: document.getElementById("children").value,
    checkin: document.getElementById("checkin").value,
    checkout: document.getElementById("checkout").value
  };
  try { const res = await fetch(WEB_APP_URL, { method:"POST", body:JSON.stringify(payload) }); const data = await res.json();
    document.getElementById("bookingResult").innerText = data.message; 
  } catch(e){ document.getElementById("bookingResult").innerText = "Network error"; }
});

// CANCEL BOOKING
document.getElementById("cancelBtn").addEventListener("click", async () => {
  const payload = { formType:"cancel", phone: document.getElementById("cancelPhone").value, checkin: document.getElementById("cancelCheckin").value };
  try { const res = await fetch(WEB_APP_URL, { method:"POST", body:JSON.stringify(payload) }); const data = await res.json();
    document.getElementById("cancelMessage").innerText = data.message; 
  } catch(e){ document.getElementById("cancelMessage").innerText = "Network error"; }
});

AOS.init({ once:true, duration:1100 });
</script>
</body>
</html>
